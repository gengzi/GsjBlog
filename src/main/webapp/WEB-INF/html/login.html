<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">


    <title>Gengzi- 登录</title>
    <meta name="keywords" content="gengzi">
    <meta name="description" content="gengzi">

    <link rel="shortcut icon" href="favicon.ico"> <link href="css/bootstrap.min.css?v=3.3.6" rel="stylesheet">
    <link href="css/font-awesome.css?v=4.4.0" rel="stylesheet">

    <link href="css/animate.css" rel="stylesheet">
    <link href="css/stylegsj.css?v=4.1.0" rel="stylesheet">
    <!--[if lt IE 9]>
    <meta http-equiv="refresh" content="0;ie.html" />
    <![endif]-->
    <script>if(window.top !== window.self){ window.top.location = window.location;}</script>
</head>

<body class="gray-bg">

    <div class="middle-box text-center loginscreen  animated fadeInDown">
        <div>
            <div>
                <h1 class="logo-name">Gz</h1>
            </div>
            <h3>欢迎登陆</h3>
            <div class="tabs-container">
                 <ul class="nav nav-tabs">
                     <li class="active"><a data-toggle="tab" href="#tab-1" aria-expanded="true"> 游客登陆</a>
                     </li>
                     <li class=""><a data-toggle="tab" href="#tab-2" aria-expanded="false"> 管理员登陆</a>
                     </li>
                 </ul>
                 <div class="tab-content">
                     <div id="tab-1" class="tab-pane active">
                         <div class="panel-body">
                             <form class="m-t" role="form" id="commonform" method="POST" action="user/login">
                             <input type="hidden" name="isadmin" value="noadmin" />
				                <div class="form-group">
				                    <input type="text" name="adminname" class="form-control" placeholder="用户名/手机号" minlength="5" maxlength="13"  required>
				                </div>
				                <div class="form-group">
				                    <input type="password" name="adminpasswd" class="form-control" placeholder="密码" required>
				                </div>
				                <button type="submit" id="commonsubmit" class="btn btn-primary block full-width m-b">登 录</button>
				
				                <p class="text-muted text-center"> <a href="login.html#"><small>忘记密码了？</small></a> | <a href="register.html">注册一个新账号</a>
				                </p>
							 </form>
                         </div>
                      </div>
                      
                      <div id="tab-2" class="tab-pane">
                           <div class="panel-body">
                               <form class="m-t" role="form" id="amdinform" method="POST" action="user/login">
                               		<input type="hidden" name="isadmin" value="admin" />
					                <div class="form-group">
					                    <input id="adminname" name="adminname"  type="text" class="form-control" placeholder="管理员ID"  minlength="5" maxlength="10"  required>
					                </div>
					                <div class="form-group">
					                    <input id="adminpasswd" name="adminpasswd" type="password" class="form-control" placeholder="密码" required>
					                </div>
					                <button id="adminsubmit" type="submit" class="btn btn-primary block full-width m-b">登 录</button>
					
					                <p class="text-muted text-center"></p>
				             </form>
                           </div>
                      </div>
                      
                 </div>
            </div>
        </div>
    </div>


    <!-- 全局js -->
    <script src="js/jquery.min.js?v=2.1.4"></script>
    <script src="js/bootstrap.min.js?v=3.3.6"></script>
    
    <!-- layer-->
    <script src="layer/layer.js"></script>
    

    
    <!-- jquery-validate 校验表单  -->
    <script src="jquery-validation-1.14.0/lib/jquery.js"></script>
    <script src="jquery-validation-1.14.0/lib/jquery.form.js"></script>
    <script src="jquery-validation-1.14.0/dist/jquery.validate.min.js"></script>
	<script src="jquery-validation-1.14.0/dist/localization/messages_zh.min.js"></script>
	
	<!-- cookie 需要放在 校验表单的后面 -->
    <script src="js/plugins/cookie/jquery.cookie.js"></script>
    
    <script type="text/javascript" src="http://tajs.qq.com/stats?sId=9051096" charset="UTF-8"></script>
    <!--统计代码，可删除-->
    
    <script type="text/javascript">
    	//管理员用户登陆
    	$("#adminsubmit").click(function(){
    		$("#amdinform").validate({
    		    submitHandler:function(form){
    		    	layer.msg('正在登陆...');
    		    	$(form).ajaxSubmit({
  		    		  dataType:"json",
		    		  success:function(data){
		                    if(data.userid != null ){
		                    	//跳转到后台管理界面
		                    	$(location).attr('href', 'admin/index_admin');
		                        //用户登陆成功，跳转界面
		                    	//信息框-例5
		                    	layer.msg('正在跳转到管理页面,请稍等', function(){
		                    	//关闭后的操作
		                    	});
		                    }else{
		                        //用户登陆失败，提示用户重新输入
		                    	layer.msg('登陆失败,请核对账号或者密码', {icon: 5});
		                    }
		                  }
		                });
    		    	}
    	        });    
    	});
   
    	
    	//一般用户登陆
    	$("#commonsubmit").click(function(){
    		$("#commonform").validate({
    		    submitHandler:function(form){
    		    	layer.msg('正在登陆...');
    		    	$(form).ajaxSubmit({
    		    		  dataType:"json",
    		    		  success:function(data){
    		                    if(data.userid != null ){
    		                    	//跳转到后台管理界面
    		                    	$(location).attr('href', 'index');
    		                        //用户登陆成功，跳转界面
    		                    	//信息框-例5
    		                    	layer.msg('正在跳转到主页,请稍等', function(){
    		                    	//关闭后的操作
    		                    	});
    		                    }else{
    		                        //用户登陆失败，提示用户重新输入
    		                    	layer.msg('登陆失败,请核对账号或者密码', {icon: 5});
    		                    }
    		                  }
    		                });     
    	        }    
    		});
    	});

    </script>
    
     <script type="text/javascript">
	    //判断用户是否已经登陆
	   	//拿到cookie 对应的值
	  	$(function(){
	  		var gsjcookieval  = $.cookie('gsjcookie');
		   	if(gsjcookieval ==null){
		   		//不存在该cookie
		   	}else{
		   		//存在cookie,就去请求后台
		   		logined(gsjcookieval);
			}
	  	});
	   
	   	//获取登陆信息
	   	function logined(gsjcookie_val){
	    	var cookieurl = "user/logininfo/"+gsjcookie_val;
	    	$.ajax({
	         		  url: cookieurl,
	         		  type: "GET",
	     			  dataType: "json",
	     			  success:function(data){
	     				 $(location).attr('href', 'index');
	     				 layer.msg('您已经登陆,正在跳转到主页');
	     			  }
	     			});
	   		}
    </script>
    

</body>

</html>
